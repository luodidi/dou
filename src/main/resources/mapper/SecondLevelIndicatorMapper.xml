<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://www.mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.whut.dao.ISecondLevelIndicatorDao">

    <insert id="insertSecondLevelIndicator" parameterType="com.whut.bean.SecondLevelIndicator">
        insert into secondlevelindicators
        values
        (
        null,
        #{firstLevelIndicatorId},
        #{content},
        #{addDate},
        #{isDelete},
        '1970-01-01'
        )
        <selectKey resultType="Integer" order="AFTER" keyProperty="id">
            SELECT LAST_INSERT_ID()
        </selectKey>
    </insert>

    <update id="updateSecondLevelIndicator" parameterType="com.whut.bean.SecondLevelIndicator">
        update secondlevelindicators
        set
        firstLevelIndicatorId=#{firstLevelIndicatorId},
        content=#{content},
        addDate=#{addDate},
        isDelete=#{isDelete},
        deleteDate=#{deleteDate}
        where id=#{id}
    </update>

    <select id="getListSecondLevelIndicator" resultType="java.util.Map" parameterType="java.lang.Integer">
        select *
        from secondlevelindicators
        where firstLevelIndicatorId=#{firstLevelIndicatorId} and isDelete=0
    </select>

    <!--
    由一级指标id获取其所有的二级指标（不分页）
    -->
    <select id="getAllListSecondLevelIndicator" resultType="java.util.Map" parameterType="java.lang.Integer">
        select id,content
        from secondlevelindicators
        where firstLevelIndicatorId=#{firstLevelIndicatorId} and isDelete=0
    </select>

    <!--
    由二级指标id获得其详情
    -->
    <select id="getDetailSecondLevelIndicator" resultType="java.util.Map" parameterType="java.lang.Integer">
        select s.id,f.project,s.content,s.addDate,s.isDelete,s.deleteDate
        from secondlevelindicators as s,firstlevelindicators as f
        where s.id=#{SecondLevelIndicatorId} and s.firstLevelIndicatorId=f.id
    </select>

    <!--
    根据二级指标id删除
    -->
    <update id="deleteSecondLevelIndicator" parameterType="java.lang.Integer">
        update secondlevelindicators
        set isDelete=1
        where id=#{secondLevelIndicatorId}
    </update>
</mapper>